5 CLS:C=7:I=270:J=275
6 SCREEN 9,,0,0:PALETTE 1,44
10 DIM A(3,3,2),B(2,2),G(3,3),FX(11),FY(11)
20 GOSUB 10000
23 DATA 120,125,220,125,120,225,220,225
25 READ X,Y
28 CIRCLE(X,Y),9,15:CIRCLE(300+X,Y),9,15
29 IF BV>-3 THEN BV=BV-1:GOTO 23
30 PAINT(23,27),8,15:PAINT(323,27),8,15
31 FOR Q=1 TO 6:FOR W=1 TO 3
40 Q1=(Q-1) MOD 3 +1:Q2=Q\3:P= (1000*RND) MOD 12:A(Q1,W,Q2)=P:GOSUB 20000
50 NEXT :NEXT
60 GOTO 1400
90 Y$= INKEY$
95 IF Y$="" THEN GOTO 90
100 A= INSTR("+-1397qwas",Y$)
105 T=15
110 ON A GOTO 1000,1100,1200,1300,1400,1500,1600,1700,1800,1900
120 GOTO 90
1000 K=1:GOTO 3000
1100 K=-1:GOTO 3000
1200 CIRCLE(I,J),43,0:CIRCLE(70 ,75 ),43,14
1205 CIRCLE(I+300,J),43,0:CIRCLE(370 ,75 ),43,14:I=70:J=75:GOTO 90
1300 CIRCLE(I,J),43,0:CIRCLE(270, 75),43,14
1305 CIRCLE(I+300,J),43,0:CIRCLE(570 ,75 ),43,14:I=270:J=75:GOTO 90
1400 CIRCLE(I,J),43,0:CIRCLE(270,275),43,14
1405 CIRCLE(I+300,J),43,0:CIRCLE(570 ,275 ),43,14:I=270:J=275:GOTO 90
1500 CIRCLE(I,J),43,0:CIRCLE( 70,275),43,14
1505 CIRCLE(I+300,J),43,0:CIRCLE(370 ,275 ),43,14:I=70:J=275:GOTO 90
1600 B(1,2)=1-B(1,2):PAINT(120,225),B(1,2),T:PAINT(420,225),1-B(1,2),T:GOTO 2500
1700 B(2,2)=1-B(2,2):PAINT(220,225),B(2,2),T:PAINT(520,225),1-B(2,2),T:GOTO 2500
1800 B(1,1)=1-B(1,1):PAINT(120,125),B(1,1),T:PAINT(420,125),1-B(1,1),T:GOTO 2500
1900 B(2,1)=1-B(2,1):PAINT(220,125),B(2,1),T:PAINT(520,125),1-B(2,1),T:GOTO 2500
2500 FOR X=1 TO 3:FOR Y=1 TO 3:G(X,Y)=0:NEXT :NEXT
2510 FOR X=1 TO 2:FOR Y=1 TO 2
2520 IF B(X,Y)=1 THEN G(X,Y)=1:G(X+1,Y)=1:G(X,Y+1)=1:G(X+1,Y+1)=1
2530 NEXT :NEXT
2560 GOTO 90
3000 D=G((I+30)/100,(J+30)/100)
3001 'SCREEN 9,,NP XOR 1 ,NP:PCOPY NP,NP XOR 1
3005 FOR X=1 TO 3 STEP 2-D:FOR Y=1 TO 3 STEP 2-D
3010 IF G(X,Y)=D THEN P1=A(X,Y):A(X,Y)=(A(X,Y)+K+12) MOD 12:Q=X:W=Y ELSE GOTO 3020
3011  REM SCREEN 9,,NP XOR 1 ,NP:PCOPY NP,NP XOR 1
3012 P=P1:C=0:GOSUB 20000
3017 P=A(X,Y):C=7:GOSUB 20000
3018 'SCREEN 9,,NPxor 1,NP XOR 1:NP=NP XOR 1
3020 NEXT :NEXT
3028 'SCREEN 9,,NP XOR 1,NP XOR 1:NP=NP XOR 1
3030 S=0
3050 X=S MOD 3+1:Y=S\3+1
3060 IF A(X,Y)>0 THEN GOTO 3130
3070 IF S<8 THEN S=S+1:GOTO 3050 ELSE LOCATE 1,1:PRINT "nikises":END
3100 END
3130 GOTO 90
9999  '****  ARXIKH SXEDIASH KYKLVN,YPOLOGISMOS fx(p),fy(p)
10000 'SCREEN 9
10010 WINDOW (0,-75)-(639,425)
10020 CLS
10030 KEY OFF
11000 FOR Y=75 TO 275 STEP 100
11010 FOR X=70 TO 570 STEP 100
11020 CIRCLE (X,Y),40
11030 LINE (X+35,Y)-(X+40,Y)
11040 LINE (X-35,Y)-(X-40,Y)
11050 LINE (X,Y+35)-(X,Y+40)
11060 LINE (X,Y-35)-(X,Y-40)
11070 NEXT
11080 NEXT
11090 LINE (20,25)-(619,334),,B
11100 LINE (319,25)-(319,334)
12000 FX(0)=0: FY(0)=30:FX(3)=30:FY(3)=0  :FX(6)=0  :FY(6)=-30:FX(9 )=-30
12010 FX(1)=15:FY(1)=26:FX(4)=26:FY(4)=-15:FX(7)=-15:FY(7)=-26:FX(10)=-26
12020 FX(2)=26:FY(2)=15:FX(5)=15:FY(5)=-26:FX(8)=-26:FY(8)=-15:FX(11)=-15
12030 FY(9)=0 :FY(10)=15: FY(11)=26
12040 RETURN
20000 '*** clock q,w; position p; color c
20010 AX=-30+100*Q
20020 AY=-25+100*W
20030 LINE (AX,AY)-(AX+FX(P),AY+FY(P)),C
20040 RETURN
